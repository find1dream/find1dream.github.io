<!DOCTYPE html> <html> <head> <!-- Begin Jekyll SEO tag v2.6.1 --> <title>Bellman Equation V(s) Proof | Blog</title> <meta name="generator" content="Jekyll v3.8.7" /> <meta property="og:title" content="Bellman Equation V(s) Proof" /> <meta name="author" content="Linfeng Chen" /> <meta property="og:locale" content="en" /> <meta name="description" content="An gentle way to show the key point in reinforcement learning" /> <meta property="og:description" content="An gentle way to show the key point in reinforcement learning" /> <link rel="canonical" href="http://find1dream.github.io/en/Bellman_Fuction_Proof" /> <meta property="og:url" content="http://find1dream.github.io/en/Bellman_Fuction_Proof" /> <meta property="og:site_name" content="Blog" /> <meta property="og:type" content="article" /> <meta property="article:published_time" content="2019-07-08T00:00:00+09:00" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"Linfeng Chen"},"headline":"Bellman Equation V(s) Proof","url":"http://find1dream.github.io/en/Bellman_Fuction_Proof","datePublished":"2019-07-08T00:00:00+09:00","description":"An gentle way to show the key point in reinforcement learning","dateModified":"2019-07-08T00:00:00+09:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://find1dream.github.io/en/Bellman_Fuction_Proof"},"@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> <meta name="msvalidate.01" content="9BA9FDD8EA34D27F827CC11CF3A2D49D" /> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" /> <!--[if lte IE 9]><meta http-equiv="refresh" content="0;url=/ie.html"><![endif]--> <meta name="author" content="Linfeng Chen"> <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,400italic,600|Droid+Sans+Mono' rel='stylesheet' type='text/css'> <link rel="shortcut icon" href="/assets/img/81icon.png" /> <link rel="stylesheet" href="/css/main.css"> <link rel="canonical" href="http://find1dream.github.io/en/Bellman_Fuction_Proof"> <link type="application/atom+xml" rel="alternate" href="http://find1dream.github.io/feed.xml" title="Blog" /> <script src="/assets/js/prefixfree.js"></script> <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script> <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script> <link rel="stylesheet" href="/css/syntax.css"> <!-- <link rel="stylesheet" href="/assets/js/katex/katex.css"> <script src="/assets/js/katex/katex.js"></script> --> <link rel="stylesheet" href="/assets/js/katex/katex.css"> <meta content="Blog" property="og:site_name"> <meta content="article" property="og:type"> <!-- <title> </title> --> <title> Life is hack </title> <meta content="An gentle way to show the key point in reinforcement learning" property="og:description"> <meta content="http://find1dream.github.io/en/Bellman_Fuction_Proof" property="og:url"> <meta content="2019-07-08T00:00:00+09:00" property="article:published_time"> <meta content="http://find1dream.github.io/about/" property="article:author"> <meta content="/img/logo-high-resolution.png" property="og:image"> <meta content="en" property="article:section"> <meta content="Reinforcement Learning" property="article:tag"> <meta content="Math" property="article:tag"> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-143337798-1', 'auto'); ga('send', 'pageview'); </script> </head> <!-- Begin Jekyll SEO tag v2.6.1 --> <title>PCA And SVD | Blog</title> <meta name="generator" content="Jekyll v3.8.7" /> <meta property="og:title" content="PCA And SVD" /> <meta name="author" content="Linfeng Chen" /> <meta property="og:locale" content="en" /> <meta name="description" content="An gentle way to show the key point of bounding box." /> <meta property="og:description" content="An gentle way to show the key point of bounding box." /> <link rel="canonical" href="http://find1dream.github.io/en/PCA_and_SVD" /> <meta property="og:url" content="http://find1dream.github.io/en/PCA_and_SVD" /> <meta property="og:site_name" content="Blog" /> <meta property="og:type" content="article" /> <meta property="article:published_time" content="2019-08-25T00:00:00+09:00" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"Linfeng Chen"},"headline":"PCA And SVD","url":"http://find1dream.github.io/en/PCA_and_SVD","datePublished":"2019-08-25T00:00:00+09:00","description":"An gentle way to show the key point of bounding box.","dateModified":"2019-08-25T00:00:00+09:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://find1dream.github.io/en/PCA_and_SVD"},"@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> <body> <meta name="viewport" content="width=device-width, initial-scale=1"> <style> .dropbtn { background-color: #696969; color: rgba(255,255,255,0.7); padding: 12px; font-size: 16px; border: none; box-sizing: content-box; width: 100%; text-align: center; border-bottom:1px solid #fff; } .dropup { position: relative; display: inline-block; } .dropup-content { display: none; position: absolute; background-color: #f1f1f1; min-width: 120px; bottom: 40px; z-index: 1; } .dropup-content p { color: black; padding: 10px 0px; text-decoration: none; display: block; text-align: center; text-decoration: underline; } .dropup-content p:hover {background-color: #ccc;} .dropup:hover .dropup-content {display: block;} .dropup:hover .dropbtn {background-color: #ddd;} .mystyle { width: 100%; padding: 25px; background-color: coral; color: white; font-size: 25px; } </style> <style> .sidebar-tags { background-color: #696969; color: rgba(255,255,255,0.7); padding: 11px 45px 11px 44px; position: relative; top: 14px; font-size: 16px; border: none; box-sizing: content-box; width: 100%; text-align: center; text-decoration: none; border-bottom: 1px solid #fff; } .sidebar-archives { background-color: #696969; color: rgba(255,255,255,0.7); padding: 11px 29px 11px 29px; position: relative; top: 45px; font-size: 16px; border: none; box-sizing: content-box; width: 100%; text-align: center; text-decoration: none; border-bottom: 1px solid #fff; } } </style> <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script> <script>function initialization() { var elements_en = document.getElementsByClassName("sidebar-tag en"); var elements_ch = document.getElementsByClassName("sidebar-tag ch"); var elements_ja = document.getElementsByClassName("sidebar-tag ja"); for (var i = 0; i < elements_ch.length; i++){ elements_ch[i].style.display = 'block'; } for (var i = 0; i < elements_en.length; i++){ elements_en[i].style.display = 'none'; } for (var i = 0; i < elements_ja.length; i++){ elements_ja[i].style.display = 'none'; } } </script> <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script> <script>function myFunction_ch() { var elements_en = document.getElementsByClassName("sidebar-tag en"); var elements_ch = document.getElementsByClassName("sidebar-tag ch"); var elements_ja = document.getElementsByClassName("sidebar-tag ja"); for (var i = 0; i < elements_ch.length; i++){ elements_ch[i].style.display = 'block'; } for (var i = 0; i < elements_en.length; i++){ elements_en[i].style.display = 'none'; } for (var i = 0; i < elements_ja.length; i++){ elements_ja[i].style.display = 'none'; } }</script> <script>function myFunction_en() { var elements_en = document.getElementsByClassName("sidebar-tag en"); var elements_ch = document.getElementsByClassName("sidebar-tag ch"); var elements_ja = document.getElementsByClassName("sidebar-tag ja"); for (var i = 0; i < elements_ch.length; i++){ elements_ch[i].style.display = 'none'; } for (var i = 0; i < elements_en.length; i++){ elements_en[i].style.display = 'block'; } for (var i = 0; i < elements_ja.length; i++){ elements_ja[i].style.display = 'none'; } elements_en[0].style.display = 'none'; }</script> <script>function myFunction_ja() { var elements_en = document.getElementsByClassName("sidebar-tag en"); var elements_ch = document.getElementsByClassName("sidebar-tag ch"); var elements_ja = document.getElementsByClassName("sidebar-tag ja"); for (var i = 0; i < elements_ch.length; i++){ elements_ch[i].style.display = 'none'; } for (var i = 0; i < elements_en.length; i++){ elements_en[i].style.display = 'none'; } for (var i = 0; i < elements_ja.length; i++){ elements_ja[i].style.display = 'block'; } elements_ja[0].style.display = 'none'; }</script> <script>function reset(){ window.location.href.split("?")[0]; window.location.reload(); window.location.replace("/"); } </script> <script>function readMe_language(){ var avatar = document.getElementById("sidebar-avatar-img"); console.log(avatar); } </script> <aside id="sidebar" class="open"> <div id="sidebar-left"> <a id="sidebar-avatar" href="/"> <img id="sidebar-avatar-img" alt="" src="/assets/img/81icon.png"/> </a> <div id="sidebar-social"> <a href="/pages/feed.xml" class="sidebar-social-icon feed"></a> <a href="mailto:clinfeng.jlu@gmail.com" class="sidebar-social-icon email"></a> <!-- Generate icon by yourself https://icomoon.io/app/#/select --> <a href="https://github.com/find1dream" class="sidebar-social-icon github" target="_blank"></a> </div> <p></p> <ul id="sidebar-tags" class = "testa"> <div class="dropup"> <button class="dropbtn">Language</button> <div class="dropup-content"> <p onclick="myFunction_ch()">中文</p> <p onclick="myFunction_en()">English</p> <p onclick="myFunction_ja()">日本語</p> </div> </div> <li class="sidebar-tag active" data-filter="recent">Latest</li> <li class="sidebar-tag en" data-filter="en">en</li> <li class="sidebar-tag en" data-filter="Tech">Tech</li> <li class="sidebar-tag ch" data-filter="分享">分享</li> <li class="sidebar-tag ch" data-filter="读书">读书</li> <li class="sidebar-tag ja" data-filter="ja">ja</li> <li class="sidebar-tag ja" data-filter="読書">読書</li> <li class="sidebar-tag en" data-filter="Share">Share</li> <script>initialization();</script> <a class="sidebar-tags" href="/pages/tags.html">tags</a> <a class="sidebar-archives" href="/pages/archive.html">archives</a> </ul> </div> <div id="sidebar-right"> <div id="search-box"> <input id="search-input" type="text" placeholder="Search" /> </div> <nav id="toc"> <!-- <a onclick="window.location.href=this" class="toc-link ch" data-tags="分享" href="/ch/get_highly_skilled_foreign_professionals_visa_in_japan">DIY 申请高度专门职1号那些事</a> --> <a class="toc-link ch" data-tags="分享" href="/ch/get_highly_skilled_foreign_professionals_visa_in_japan">DIY 申请高度专门职1号那些事</a> <a class="toc-link en" data-tags="en Tech" href="/en/How_to_train_multiple_model_in_one_time_with_sklearn">How To Train Multiple Model In One Time With Sklearn</a> <a class="toc-link en" data-tags="en Tech" href="/en/Pandas_tricks">Pandas Tricks</a> <a class="toc-link en" data-tags="en Tech" href="/en/A_least_squares_approach">A Least Squares Approach</a> <a class="toc-link en" data-tags="en Tech" href="/en/Linear_modeling_Maximum_likelihood_approach">Linear Modeling - A Maximum Likelihood Approach</a> <a class="toc-link en" data-tags="en Tech" href="/en/Bayesian_approach_to_machine_learning">The Bayesian Approach To Machine Learning</a> <a class="toc-link en" data-tags="en Tech" href="/en/An_introduction_to_ESN">An Introduction To ESN</a> <a class="toc-link en" data-tags="en Tech" href="/en/Modeling_with_NMF_and_SVD">Modeling With NMF And SVD</a> <a class="toc-link en" data-tags="en Share" href="/en/Interesting_papers_to_replicate">Interesting Papers To Replicate</a> <a class="toc-link en" data-tags="en Share" href="/en/Feature_engineering">Feature Engineering For Machine Learning</a> <a class="toc-link en" data-tags="en Share" href="/en/C++_tricks">Usefull C++ Tricks</a> <a class="toc-link en" data-tags="en Tech" href="/en/PCA_and_SVD">PCA And SVD</a> <a class="toc-link en" data-tags="en Share" href="/en/How_to_change_CNN_structure_in_running_time_with_pytorch">An Easy Way To Change CNN Structure In Running Time With Pytorch</a> <a class="toc-link ja" data-tags="ja 読書" href="/ja/reviews-how_to_increase_your_money_in_an_easy_way">【Book Review】難しいことはわかりませんが、お金の増やし方を教えてください</a> <a class="toc-link en" data-tags="en Tech" href="/en/Bounding_box_introduction">Bounding Box Regression</a> <a class="toc-link ja" data-tags="ja 読書" href="/ja/reviews-boki_for_beginer_with_manga">【Book Review】オールカラー　マンガでわかる！はじめての簿記</a> <a class="toc-link en" data-tags="en Tech" href="/en/Flappy_Bird_DQN_with_Pytorch">It's Really Easy To Play Flappy Bird Via Reinforcement Learning</a> <!-- <a onclick="window.location.href=this" class="toc-link ch" data-tags="读书" href="/ch/reviews-attitude">【Book Review】态度</a> --> <a class="toc-link ch" data-tags="读书" href="/ch/reviews-attitude">【Book Review】态度</a> <!-- <a onclick="window.location.href=this" class="toc-link ch" data-tags="读书" href="/ch/reviews-complete_writing_guide">【Book Review】完全写作指南</a> --> <a class="toc-link ch" data-tags="读书" href="/ch/reviews-complete_writing_guide">【Book Review】完全写作指南</a> <a class="toc-link en" data-tags="en Tech" href="/en/Cart_Pole_example_for_Temporal_Difference_learning_with_Pytorch">How To Play Cart Pole Game with Temporal Difference Learning By Pytorch?</a> <!-- <a onclick="window.location.href=this" class="toc-link ch" data-tags="分享" href="/ch/how_to_improve_japanese_skills_from_N1">日语通过 N1 之后如何进阶？</a> --> <a class="toc-link ch" data-tags="分享" href="/ch/how_to_improve_japanese_skills_from_N1">日语通过 N1 之后如何进阶？</a> <a class="toc-link en" data-tags="en Tech" href="/en/An_introduction_to_Temporal-Difference_learning">An Easy Way To Understand Temporal-Difference Learning In Reinforcement Learning</a> <!-- <a onclick="window.location.href=this" class="toc-link ch" data-tags="读书" href="/ch/reviews-learn_how_to_write">【Book Review】学会写作：自我进阶的高效方法</a> --> <a class="toc-link ch" data-tags="读书" href="/ch/reviews-learn_how_to_write">【Book Review】学会写作：自我进阶的高效方法</a> <a class="toc-link en" data-tags="en Tech" href="/en/Importance_sampling_proof">Importance Sampling In Reinforcement learning</a> <!-- <a onclick="window.location.href=this" class="toc-link ch" data-tags="分享" href="/ch/how_to_make_practical_mindmaps_with_Marginnote-tool">如何用 Marginnote 做实用性强的思维导图（实践篇）</a> --> <a class="toc-link ch" data-tags="分享" href="/ch/how_to_make_practical_mindmaps_with_Marginnote-tool">如何用 Marginnote 做实用性强的思维导图（实践篇）</a> <!-- <a onclick="window.location.href=this" class="toc-link ch" data-tags="分享" href="/ch/how_to_make_practical_mindmaps_with_Marginnote-theory">如何用 Marginnote 做实用性强的思维导图（理论篇）</a> --> <a class="toc-link ch" data-tags="分享" href="/ch/how_to_make_practical_mindmaps_with_Marginnote-theory">如何用 Marginnote 做实用性强的思维导图（理论篇）</a> <a class="toc-link en" data-tags="en Tech" href="/en/An_introduction_to_Monte_Carlo_learning">An Easy Way To Understand Monte Carlo Learning In Reinforcement Learning</a> <a class="toc-link en" data-tags="en Tech" href="/en/An_introduction_to_dynamic_programming">An Easy Way To Understand Dynamic Programming In Reinforcement Learning</a> <a class="toc-link en" data-tags="en Tech" href="/en/An_introduction_to_mdp">An Easy Way To Understand Markov Decision Process In Reinforcement Learning</a> <!-- <a onclick="window.location.href=this" class="toc-link ch" data-tags="分享" href="/ch/why_do_I_choose_Jekyll_to_write_blog">为什么我选择 Jekyll + Github Pages 而不是 Wordpress 写技术博客？</a> --> <a class="toc-link ch" data-tags="分享" href="/ch/why_do_I_choose_Jekyll_to_write_blog">为什么我选择 Jekyll + Github Pages 而不是 Wordpress 写技术博客？</a> <a class="toc-link en" data-tags="en Tech" href="/en/The_Easiest_Introduction_To_Cross_Validation">The Easiest Introduction To Cross Validation</a> <a class="toc-link en" data-tags="en Tech" href="/en/How_To_Use_SVM_In_Python">How To Use SVM In Python?</a> <a class="toc-link en" data-tags="en Tech" href="/en/Bellman_Fuction_Proof">Bellman Equation V(s) Proof</a> </nav> </div> </aside> <main id="main" class="open"> <link rel="stylesheet" href="/css/en_font.css"> <article class="post container"> <div class="post-meta"> <span class="post-meta-span date">2019 August 25</span> <span class="post-meta-span tag">Machine Learning</span> <span id="busuanzi_container_page_pv" text-align="center"> <span id="busuanzi_value_page_pv"></span> </span> </div> <h1 class="post-title">PCA And SVD</h1> <hr align="center" width="14%"> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script> <!-- horizontal_ads --> <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4428678099867228" data-ad-slot="2208981001" data-ad-format="auto" data-full-width-responsive="true"></ins> <script> (adsbygoogle = window.adsbygoogle || []).push({}); </script> <h2 id="what-can-pca-do">What can PCA do?</h2> <ul> <li><strong>Compress</strong>: If you want to compress a photo, PCA is a method. It can compress the photo greatly without lossing to much of the definition</li> <li><strong>Dimension Reduction</strong>: Well known in Machine Learning, to lower down the noise, and reduce the features that are unnecessary to get a faster and more accurate result.</li> <li><strong>Data Visualization</strong>: It can take 4 or more variables and make a 2-D PCA plot</li> <li><strong>Choose Main Variables</strong>: It can tell us which variable is the most valuable for clustring the data.</li> </ul> <h2 id="how-to-use-it">How to use it?</h2> <p>Code:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># PCA
</span><span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">310</span><span class="p">)</span>
<span class="n">X_scaled</span><span class="o">=</span><span class="n">pca</span><span class="p">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="c1"># SVD
</span><span class="n">U</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="n">svd</span><span class="p">(</span><span class="n">X</span><span class="p">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">X</span><span class="p">)</span>
<span class="n">Xrot</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">,</span> <span class="n">U</span><span class="p">[:,:</span><span class="mi">100</span><span class="p">])</span> <span class="c1"># decorrelate the data```
</span>

<span class="c1">### SVD
#### How to use SVD to reconstruct a matrix?
</span><span class="n">row</span> <span class="n">matrix</span> <span class="n">A</span> <span class="o">=</span> <span class="n">U</span> <span class="o">*</span> <span class="n">Sigma</span> <span class="o">*</span> <span class="n">V</span><span class="o">^</span><span class="n">T</span>
<span class="sb">``</span><span class="err">`</span><span class="n">python</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]])</span>
<span class="n">U</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="n">svd</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="n">Sigma</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">A</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">A</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="n">shape</span> <span class="o">=</span> <span class="n">A</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">A</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">A</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">else</span> <span class="n">A</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">Sigma</span><span class="p">[:</span><span class="n">shape</span><span class="p">,:</span><span class="n">shape</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">diag</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

<span class="n">B</span> <span class="o">=</span> <span class="n">U</span><span class="p">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Sigma</span><span class="p">.</span><span class="n">dot</span><span class="p">(</span><span class="n">V</span><span class="p">))</span> <span class="c1"># or U @ Sigma @ V
</span><span class="k">print</span><span class="p">(</span><span class="n">B</span><span class="p">)</span><span class="sb">``</span><span class="err">`</span>

<span class="c1">#### pseudoinverse(Generalized Inverse)
</span><span class="n">A</span><span class="o">^+</span> <span class="n">means</span> <span class="n">pseudoinverse</span>
<span class="n">A</span><span class="o">^+</span> <span class="o">=</span> <span class="n">V</span> <span class="o">*</span> <span class="n">D</span><span class="o">^+</span> <span class="o">*</span> <span class="n">U</span><span class="o">^</span><span class="n">T</span>
<span class="n">A</span><span class="o">^+</span> <span class="ow">is</span> <span class="n">pseudoinverse</span> <span class="n">of</span> <span class="n">A</span><span class="p">,</span> <span class="n">D</span><span class="o">^+</span> <span class="ow">is</span> <span class="n">pseudoinverse</span> <span class="n">of</span> <span class="n">Sigma</span><span class="p">,</span> <span class="n">U</span><span class="o">^</span><span class="n">T</span> <span class="ow">is</span> <span class="n">transponse</span> <span class="n">of</span> <span class="n">U</span><span class="p">.</span>
<span class="n">We</span> <span class="n">can</span> <span class="n">use</span> <span class="n">U</span> <span class="o">*</span> <span class="n">Sigma</span> <span class="o">*</span> <span class="n">V</span><span class="o">^</span><span class="n">T</span> <span class="n">to</span> <span class="n">compute</span> <span class="n">U</span><span class="p">,</span> <span class="n">Sigma</span> <span class="ow">and</span> <span class="n">V</span> <span class="n">to</span> <span class="n">get</span> <span class="n">pseudoinverse</span><span class="p">.</span>

<span class="sb">``</span><span class="err">`</span><span class="n">python</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]])</span>
<span class="n">U</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="n">svd</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>  <span class="c1"># ( V is  V.T)
</span><span class="n">Sigma</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">A</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">A</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="n">shape</span> <span class="o">=</span> <span class="n">A</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">A</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">A</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">else</span> <span class="n">A</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">Sigma</span><span class="p">[:</span><span class="n">shape</span><span class="p">,:</span><span class="n">shape</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">diag</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="n">D</span> <span class="o">=</span> <span class="n">Sigma</span>
<span class="n">D</span><span class="p">[:</span><span class="n">shape</span><span class="p">,:</span><span class="n">shape</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">diag</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">s</span><span class="p">)</span>
<span class="n">Dpse</span> <span class="o">=</span> <span class="n">D</span><span class="p">.</span><span class="n">T</span>
<span class="n">Apse</span> <span class="o">=</span> <span class="n">V</span> <span class="o">@</span> <span class="n">Dpse</span> <span class="o">@</span> <span class="n">U</span><span class="p">.</span><span class="n">T</span>
<span class="k">print</span><span class="p">(</span><span class="n">Apse</span><span class="p">)</span>

<span class="c1">#or
</span>
<span class="n">Apse</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="n">svd</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">Apse</span><span class="p">)</span>
</code></pre></div></div> <h2 id="what-it-can-do">What it can do?</h2> <h3 id="svd---decomposition">SVD - decomposition</h3> <p>eg: feature numbers(columns) &gt; data numbers(rows)<br /> Then we can choose k biggest Sigma values, and choose the row from V.T, and then reconstruct the matrix: B = U * SigmaNew * VNew</p> <p>A new dataset(the projection of A): T = U * SigmaNew or T = A * VNew.T</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">)),</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">21</span><span class="p">)),</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">21</span><span class="p">,</span><span class="mi">31</span><span class="p">))])</span>
<span class="n">U</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="n">svd</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="n">Sigma</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">A</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">A</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="n">shape</span> <span class="o">=</span> <span class="n">A</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">A</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">A</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">else</span> <span class="n">A</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">Sigma</span><span class="p">[:</span><span class="n">shape</span><span class="p">,:</span><span class="n">shape</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">diag</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

<span class="c1"># select
</span><span class="n">n_elements</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">SigmaNew</span> <span class="o">=</span> <span class="n">Sigma</span><span class="p">[:,</span> <span class="p">:</span><span class="n">n_elements</span><span class="p">]</span>
<span class="n">VNew</span> <span class="o">=</span> <span class="n">V</span><span class="p">[:</span><span class="n">n_elements</span><span class="p">,</span> <span class="p">:]</span>

<span class="c1"># reconstruct
</span><span class="n">B</span> <span class="o">=</span> <span class="n">U</span> <span class="o">@</span> <span class="n">SigmaNew</span> <span class="o">@</span> <span class="n">VNew</span>

<span class="n">T</span> <span class="o">=</span> <span class="n">A</span> <span class="o">@</span> <span class="n">VNew</span><span class="p">.</span><span class="n">T</span> <span class="c1"># or
</span><span class="n">T</span> <span class="o">=</span> <span class="n">U</span> <span class="o">@</span> <span class="n">SigmaNew</span><span class="sb">``</span><span class="err">`</span>

<span class="sb">``</span><span class="err">`</span><span class="n">python</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">TruncatedSVD</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">)),</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">21</span><span class="p">)),</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">21</span><span class="p">,</span><span class="mi">31</span><span class="p">))])</span>

<span class="n">SVD</span> <span class="o">=</span> <span class="n">TruncatedSVD</span><span class="p">(</span><span class="n">n_componets</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">SVD</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">SVD</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</code></pre></div></div> <h2 id="reference">Reference:</h2> <ul> <li><a href="https://georgemdallas.wordpress.com/2013/10/30/principal-component-analysis-4-dummies-eigenvectors-eigenvalues-and-dimension-reduction/">Principal Component Analysis 4 Dummies: Eigenvectors, Eigenvalues and Dimension Reduction</a></li> <li><a href="http://www.ams.org/publicoutreach/feature-column/fcarc-svd">We Recommend a Singular Value Decomposition</a></li> </ul> <hr align="center" width="14%"> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script> <!-- horizontal_ads --> <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4428678099867228" data-ad-slot="2208981001" data-ad-format="auto" data-full-width-responsive="true"></ins> <script> (adsbygoogle = window.adsbygoogle || []).push({}); </script> <div class="relatedPosts"> <h4 id="related_posts">You May Also Enjoy</h4> <script > $("#related_posts").hide(); </script> <script > $("#related_posts").show(); </script> <div> <h5><a href="/en/How_to_train_multiple_model_in_one_time_with_sklearn">How To Train Multiple Model In One Time With Sklearn <span class="label label-default">--Machine Learning</span> </a></h5> </div> <script > $("#related_posts").show(); </script> <div> <h5><a href="/en/A_least_squares_approach">A Least Squares Approach <span class="label label-default">--Machine Learning</span> </a></h5> </div> <script > $("#related_posts").show(); </script> <div> <h5><a href="/en/Linear_modeling_Maximum_likelihood_approach">Linear Modeling - A Maximum Likelihood Approach <span class="label label-default">--Machine Learning</span> </a></h5> </div> <script > $("#related_posts").show(); </script> <div> <h5><a href="/en/Bayesian_approach_to_machine_learning">The Bayesian Approach To Machine Learning <span class="label label-default">--Machine Learning</span> </a></h5> </div> <script > $("#related_posts").show(); </script> <div> <h5><a href="/en/Modeling_with_NMF_and_SVD">Modeling With NMF And SVD <span class="label label-default">--Machine Learning</span> </a></h5> </div> <script > $("#related_posts").show(); </script> <div> <h5><a href="/en/Feature_engineering">Feature Engineering For Machine Learning <span class="label label-default">--Machine Learning</span> </a></h5> </div> </div> <p><strong>Welcome to share or comment on this post: </strong></p> </article> <div class="post-share"> <div class="container"> <!-- AddToAny BEGIN --> <div class="a2a_kit a2a_kit_size_32 a2a_default_style" style=" float: unset; display: inline-flex; place-items: center;"> <a class="a2a_dd" href="https://www.addtoany.com/share"></a> <a class="a2a_button_wechat"></a> <a class="a2a_button_evernote"></a> <a class="a2a_button_line"></a> <a class="a2a_button_sina_weibo"></a> <a class="a2a_button_douban"></a> <a class="a2a_button_qzone"></a> </div> <script> var a2a_config = a2a_config || {}; a2a_config.onclick = 1; </script> <script async src="https://static.addtoany.com/menu/page.js"></script> <!-- AddToAny END --> </div> </div> <div class="comment container"> <div id="disqus_thread"> </div> </div> <div class="footer"> <div class="container"> <p class="footer-entry">All content is licensed under <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA</a></p> <p class="footer-entry">Built with <a href="http://jekyllrb.com/" target="_blank">Jekyll</a> and <a href="https://github.com/P233/3-Jekyll" target="_blank">3-Jekyll theme</a> • Hosted on <a href="https://pages.github.com/" target="_blank">Github</a></p> </div> </div> </main> <button id="menu" class="open"> <span id="menu-icons"></span> </button> <button id="post-toc-menu"> <span id="post-toc-menu-icons"></span> </button> <div id="post-toc"> <span id="post-toc-title">Table of Contents</span> <ul id="post-toc-ul"></ul> </div> <script src="/assets/js/jquery-2.1.3.min.js"></script> <script src="/assets/js/jquery.pjax.js"></script> <script src="/assets/js/nprogress.js"></script> <script src="/assets/js/main.js"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-143337798-1', 'auto'); ga('send', 'pageview'); </script> <!-- Load jQuery --> <!-- Load KaTeX --> </body> </html>
