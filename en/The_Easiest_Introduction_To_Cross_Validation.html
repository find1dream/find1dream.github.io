<!DOCTYPE html> <html> <head> <!-- Begin Jekyll SEO tag v2.6.1 --> <title>Bellman Equation V(s) Proof | Blog</title> <meta name="generator" content="Jekyll v3.8.7" /> <meta property="og:title" content="Bellman Equation V(s) Proof" /> <meta name="author" content="Linfeng Chen" /> <meta property="og:locale" content="en" /> <meta name="description" content="An gentle way to show the key point in reinforcement learning" /> <meta property="og:description" content="An gentle way to show the key point in reinforcement learning" /> <link rel="canonical" href="http://find1dream.github.io/en/Bellman_Fuction_Proof" /> <meta property="og:url" content="http://find1dream.github.io/en/Bellman_Fuction_Proof" /> <meta property="og:site_name" content="Blog" /> <meta property="og:type" content="article" /> <meta property="article:published_time" content="2019-07-08T00:00:00+09:00" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"Linfeng Chen"},"headline":"Bellman Equation V(s) Proof","url":"http://find1dream.github.io/en/Bellman_Fuction_Proof","datePublished":"2019-07-08T00:00:00+09:00","description":"An gentle way to show the key point in reinforcement learning","dateModified":"2019-07-08T00:00:00+09:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://find1dream.github.io/en/Bellman_Fuction_Proof"},"@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> <meta name="msvalidate.01" content="9BA9FDD8EA34D27F827CC11CF3A2D49D" /> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" /> <!--[if lte IE 9]><meta http-equiv="refresh" content="0;url=/ie.html"><![endif]--> <meta name="author" content="Linfeng Chen"> <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,400italic,600|Droid+Sans+Mono' rel='stylesheet' type='text/css'> <link rel="shortcut icon" href="/assets/img/81icon.png" /> <link rel="stylesheet" href="/css/main.css"> <link rel="canonical" href="http://find1dream.github.io/en/Bellman_Fuction_Proof"> <link type="application/atom+xml" rel="alternate" href="http://find1dream.github.io/feed.xml" title="Blog" /> <script src="/assets/js/prefixfree.js"></script> <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script> <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script> <link rel="stylesheet" href="/css/syntax.css"> <!-- <link rel="stylesheet" href="/assets/js/katex/katex.css"> <script src="/assets/js/katex/katex.js"></script> --> <link rel="stylesheet" href="/assets/js/katex/katex.css"> <meta content="Blog" property="og:site_name"> <meta content="article" property="og:type"> <meta content="An gentle way to show the key point in reinforcement learning" property="og:description"> <meta content="http://find1dream.github.io/en/Bellman_Fuction_Proof" property="og:url"> <meta content="2019-07-08T00:00:00+09:00" property="article:published_time"> <meta content="http://find1dream.github.io/about/" property="article:author"> <meta content="/img/logo-high-resolution.png" property="og:image"> <meta content="en" property="article:section"> <meta content="Reinforcement Learning" property="article:tag"> <meta content="Math" property="article:tag"> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-143337798-1', 'auto'); ga('send', 'pageview'); </script> </head> <!-- Begin Jekyll SEO tag v2.6.1 --> <title>The Easiest Introduction To Cross Validation | Blog</title> <meta name="generator" content="Jekyll v3.8.7" /> <meta property="og:title" content="The Easiest Introduction To Cross Validation" /> <meta name="author" content="Linfeng Chen" /> <meta property="og:locale" content="en" /> <meta name="description" content="A detail introduction to cross validation, maybe the easiest to understand." /> <meta property="og:description" content="A detail introduction to cross validation, maybe the easiest to understand." /> <link rel="canonical" href="http://find1dream.github.io/en/The_Easiest_Introduction_To_Cross_Validation" /> <meta property="og:url" content="http://find1dream.github.io/en/The_Easiest_Introduction_To_Cross_Validation" /> <meta property="og:site_name" content="Blog" /> <meta property="og:type" content="article" /> <meta property="article:published_time" content="2019-07-10T00:00:00+09:00" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"Linfeng Chen"},"headline":"The Easiest Introduction To Cross Validation","url":"http://find1dream.github.io/en/The_Easiest_Introduction_To_Cross_Validation","datePublished":"2019-07-10T00:00:00+09:00","description":"A detail introduction to cross validation, maybe the easiest to understand.","dateModified":"2019-07-10T00:00:00+09:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://find1dream.github.io/en/The_Easiest_Introduction_To_Cross_Validation"},"@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> <body> <meta name="viewport" content="width=device-width, initial-scale=1"> <style> .dropbtn { background-color: #696969; color: rgba(255,255,255,0.7); padding: 12px; font-size: 16px; border: none; box-sizing: content-box; width: 100%; text-align: center; border-bottom:1px solid #fff; } .dropup { position: relative; display: inline-block; } .dropup-content { display: none; position: absolute; background-color: #f1f1f1; min-width: 120px; bottom: 40px; z-index: 1; } .dropup-content p { color: black; padding: 10px 0px; text-decoration: none; display: block; text-align: center; text-decoration: underline; } .dropup-content p:hover {background-color: #ccc;} .dropup:hover .dropup-content {display: block;} .dropup:hover .dropbtn {background-color: #ddd;} .mystyle { width: 100%; padding: 25px; background-color: coral; color: white; font-size: 25px; } </style> <style> .sidebar-tags { background-color: #696969; color: rgba(255,255,255,0.7); padding: 11px 45px 11px 44px; position: relative; top: 14px; font-size: 16px; border: none; box-sizing: content-box; width: 100%; text-align: center; text-decoration: none; border-bottom: 1px solid #fff; } .sidebar-archives { background-color: #696969; color: rgba(255,255,255,0.7); padding: 11px 29px 11px 29px; position: relative; top: 45px; font-size: 16px; border: none; box-sizing: content-box; width: 100%; text-align: center; text-decoration: none; border-bottom: 1px solid #fff; } } </style> <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script> <script>function initialization() { var elements_en = document.getElementsByClassName("sidebar-tag en"); var elements_ch = document.getElementsByClassName("sidebar-tag ch"); var elements_ja = document.getElementsByClassName("sidebar-tag ja"); for (var i = 0; i < elements_ch.length; i++){ elements_ch[i].style.display = 'block'; } for (var i = 0; i < elements_en.length; i++){ elements_en[i].style.display = 'none'; } for (var i = 0; i < elements_ja.length; i++){ elements_ja[i].style.display = 'none'; } } </script> <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script> <script>function myFunction_ch() { var elements_en = document.getElementsByClassName("sidebar-tag en"); var elements_ch = document.getElementsByClassName("sidebar-tag ch"); var elements_ja = document.getElementsByClassName("sidebar-tag ja"); for (var i = 0; i < elements_ch.length; i++){ elements_ch[i].style.display = 'block'; } for (var i = 0; i < elements_en.length; i++){ elements_en[i].style.display = 'none'; } for (var i = 0; i < elements_ja.length; i++){ elements_ja[i].style.display = 'none'; } }</script> <script>function myFunction_en() { var elements_en = document.getElementsByClassName("sidebar-tag en"); var elements_ch = document.getElementsByClassName("sidebar-tag ch"); var elements_ja = document.getElementsByClassName("sidebar-tag ja"); for (var i = 0; i < elements_ch.length; i++){ elements_ch[i].style.display = 'none'; } for (var i = 0; i < elements_en.length; i++){ elements_en[i].style.display = 'block'; } for (var i = 0; i < elements_ja.length; i++){ elements_ja[i].style.display = 'none'; } elements_en[0].style.display = 'none'; }</script> <script>function myFunction_ja() { var elements_en = document.getElementsByClassName("sidebar-tag en"); var elements_ch = document.getElementsByClassName("sidebar-tag ch"); var elements_ja = document.getElementsByClassName("sidebar-tag ja"); for (var i = 0; i < elements_ch.length; i++){ elements_ch[i].style.display = 'none'; } for (var i = 0; i < elements_en.length; i++){ elements_en[i].style.display = 'none'; } for (var i = 0; i < elements_ja.length; i++){ elements_ja[i].style.display = 'block'; } elements_ja[0].style.display = 'none'; }</script> <script>function reset(){ window.location.href.split("?")[0]; window.location.reload(); window.location.replace("/"); } </script> <script>function readMe_language(){ var avatar = document.getElementById("sidebar-avatar-img"); console.log(avatar); } </script> <aside id="sidebar" class="open"> <div id="sidebar-left"> <a id="sidebar-avatar" href="/"> <img id="sidebar-avatar-img" alt="" src="/assets/img/81icon.png"/> </a> <div id="sidebar-social"> <a href="/pages/feed.xml" class="sidebar-social-icon feed"></a> <a href="mailto:clinfeng.jlu@gmail.com" class="sidebar-social-icon email"></a> <!-- Generate icon by yourself https://icomoon.io/app/#/select --> <a href="https://github.com/find1dream" class="sidebar-social-icon github" target="_blank"></a> </div> <p></p> <ul id="sidebar-tags" class = "testa"> <div class="dropup"> <button class="dropbtn">Language</button> <div class="dropup-content"> <p onclick="myFunction_ch()">中文</p> <p onclick="myFunction_en()">English</p> <p onclick="myFunction_ja()">日本語</p> </div> </div> <li class="sidebar-tag active" data-filter="recent">Latest</li> <li class="sidebar-tag en" data-filter="en">en</li> <li class="sidebar-tag en" data-filter="Tech">Tech</li> <li class="sidebar-tag ch" data-filter="分享">分享</li> <li class="sidebar-tag ch" data-filter="读书">读书</li> <li class="sidebar-tag ja" data-filter="ja">ja</li> <li class="sidebar-tag ja" data-filter="読書">読書</li> <li class="sidebar-tag en" data-filter="Share">Share</li> <script>initialization();</script> <a class="sidebar-tags" href="/pages/tags.html">tags</a> <a class="sidebar-archives" href="/pages/archive.html">archives</a> </ul> </div> <div id="sidebar-right"> <div id="search-box"> <input id="search-input" type="text" placeholder="Search" /> </div> <nav id="toc"> <!-- <a onclick="window.location.href=this" class="toc-link ch" data-tags="分享" href="/ch/get_highly_skilled_foreign_professionals_visa_in_japan">DIY 申请高度专门职1号那些事</a> --> <a class="toc-link ch" data-tags="分享" href="/ch/get_highly_skilled_foreign_professionals_visa_in_japan">DIY 申请高度专门职1号那些事</a> <a class="toc-link en" data-tags="en Tech" href="/en/How_to_train_multiple_model_in_one_time_with_sklearn">How To Train Multiple Model In One Time With Sklearn</a> <a class="toc-link en" data-tags="en Tech" href="/en/Pandas_tricks">Pandas Tricks</a> <a class="toc-link en" data-tags="en Tech" href="/en/A_least_squares_approach">A Least Squares Approach</a> <a class="toc-link en" data-tags="en Tech" href="/en/Linear_modeling_Maximum_likelihood_approach">Linear Modeling - A Maximum Likelihood Approach</a> <a class="toc-link en" data-tags="en Tech" href="/en/Bayesian_approach_to_machine_learning">The Bayesian Approach To Machine Learning</a> <a class="toc-link en" data-tags="en Tech" href="/en/An_introduction_to_ESN">An Introduction To ESN</a> <a class="toc-link en" data-tags="en Tech" href="/en/Modeling_with_NMF_and_SVD">Modeling With NMF And SVD</a> <a class="toc-link en" data-tags="en Share" href="/en/Interesting_papers_to_replicate">Interesting Papers To Replicate</a> <a class="toc-link en" data-tags="en Share" href="/en/Feature_engineering">Feature Engineering For Machine Learning</a> <a class="toc-link en" data-tags="en Share" href="/en/C++_tricks">Usefull C++ Tricks</a> <a class="toc-link en" data-tags="en Tech" href="/en/PCA_and_SVD">PCA And SVD</a> <a class="toc-link en" data-tags="en Share" href="/en/How_to_change_CNN_structure_in_running_time_with_pytorch">An Easy Way To Change CNN Structure In Running Time With Pytorch</a> <a class="toc-link ja" data-tags="ja 読書" href="/ja/reviews-how_to_increase_your_money_in_an_easy_way">【Book Review】難しいことはわかりませんが、お金の増やし方を教えてください</a> <a class="toc-link en" data-tags="en Tech" href="/en/Bounding_box_introduction">Bounding Box Regression</a> <a class="toc-link ja" data-tags="ja 読書" href="/ja/reviews-boki_for_beginer_with_manga">【Book Review】オールカラー　マンガでわかる！はじめての簿記</a> <a class="toc-link en" data-tags="en Tech" href="/en/Flappy_Bird_DQN_with_Pytorch">It's Really Easy To Play Flappy Bird Via Reinforcement Learning</a> <!-- <a onclick="window.location.href=this" class="toc-link ch" data-tags="读书" href="/ch/reviews-attitude">【Book Review】态度</a> --> <a class="toc-link ch" data-tags="读书" href="/ch/reviews-attitude">【Book Review】态度</a> <!-- <a onclick="window.location.href=this" class="toc-link ch" data-tags="读书" href="/ch/reviews-complete_writing_guide">【Book Review】完全写作指南</a> --> <a class="toc-link ch" data-tags="读书" href="/ch/reviews-complete_writing_guide">【Book Review】完全写作指南</a> <a class="toc-link en" data-tags="en Tech" href="/en/Cart_Pole_example_for_Temporal_Difference_learning_with_Pytorch">How To Play Cart Pole Game with Temporal Difference Learning By Pytorch?</a> <!-- <a onclick="window.location.href=this" class="toc-link ch" data-tags="分享" href="/ch/how_to_improve_japanese_skills_from_N1">日语通过 N1 之后如何进阶？</a> --> <a class="toc-link ch" data-tags="分享" href="/ch/how_to_improve_japanese_skills_from_N1">日语通过 N1 之后如何进阶？</a> <a class="toc-link en" data-tags="en Tech" href="/en/An_introduction_to_Temporal-Difference_learning">An Easy Way To Understand Temporal-Difference Learning In Reinforcement Learning</a> <!-- <a onclick="window.location.href=this" class="toc-link ch" data-tags="读书" href="/ch/reviews-learn_how_to_write">【Book Review】学会写作：自我进阶的高效方法</a> --> <a class="toc-link ch" data-tags="读书" href="/ch/reviews-learn_how_to_write">【Book Review】学会写作：自我进阶的高效方法</a> <a class="toc-link en" data-tags="en Tech" href="/en/Importance_sampling_proof">Importance Sampling In Reinforcement learning</a> <!-- <a onclick="window.location.href=this" class="toc-link ch" data-tags="分享" href="/ch/how_to_make_practical_mindmaps_with_Marginnote-tool">如何用 Marginnote 做实用性强的思维导图（实践篇）</a> --> <a class="toc-link ch" data-tags="分享" href="/ch/how_to_make_practical_mindmaps_with_Marginnote-tool">如何用 Marginnote 做实用性强的思维导图（实践篇）</a> <!-- <a onclick="window.location.href=this" class="toc-link ch" data-tags="分享" href="/ch/how_to_make_practical_mindmaps_with_Marginnote-theory">如何用 Marginnote 做实用性强的思维导图（理论篇）</a> --> <a class="toc-link ch" data-tags="分享" href="/ch/how_to_make_practical_mindmaps_with_Marginnote-theory">如何用 Marginnote 做实用性强的思维导图（理论篇）</a> <a class="toc-link en" data-tags="en Tech" href="/en/An_introduction_to_Monte_Carlo_learning">An Easy Way To Understand Monte Carlo Learning In Reinforcement Learning</a> <a class="toc-link en" data-tags="en Tech" href="/en/An_introduction_to_dynamic_programming">An Easy Way To Understand Dynamic Programming In Reinforcement Learning</a> <a class="toc-link en" data-tags="en Tech" href="/en/An_introduction_to_mdp">An Easy Way To Understand Markov Decision Process In Reinforcement Learning</a> <!-- <a onclick="window.location.href=this" class="toc-link ch" data-tags="分享" href="/ch/why_do_I_choose_Jekyll_to_write_blog">为什么我选择 Jekyll + Github Pages 而不是 Wordpress 写技术博客？</a> --> <a class="toc-link ch" data-tags="分享" href="/ch/why_do_I_choose_Jekyll_to_write_blog">为什么我选择 Jekyll + Github Pages 而不是 Wordpress 写技术博客？</a> <a class="toc-link en" data-tags="en Tech" href="/en/The_Easiest_Introduction_To_Cross_Validation">The Easiest Introduction To Cross Validation</a> <a class="toc-link en" data-tags="en Tech" href="/en/How_To_Use_SVM_In_Python">How To Use SVM In Python?</a> <a class="toc-link en" data-tags="en Tech" href="/en/Bellman_Fuction_Proof">Bellman Equation V(s) Proof</a> </nav> </div> </aside> <main id="main" class="open"> <link rel="stylesheet" href="/css/en_font.css"> <article class="post container"> <div class="post-meta"> <span class="post-meta-span date">2019 July 10</span> <span class="post-meta-span tag">Generazation, Machine Learning</span> <span id="busuanzi_container_page_pv" text-align="center"> <span id="busuanzi_value_page_pv"></span> </span> </div> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script> <!-- horizontal_ads --> <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4428678099867228" data-ad-slot="2208981001" data-ad-format="auto" data-full-width-responsive="true"></ins> <script> (adsbygoogle = window.adsbygoogle || []).push({}); </script> <h1 class="post-title">The Easiest Introduction To Cross Validation</h1> <hr align="center" width="14%"> <h2 id="what-is-cross-validation">What is Cross validation?</h2> <p>Cross-validation is a <strong>technique</strong> that is used for the assessment of how the results of statistical analysis <strong>generalize</strong> to an independent data set. It’s a statistical method of evaluating and comparing learning algorithms by dividing data into two segments: one used to learn or train a model and the other used to validate the model. In typical cross-validation, the training and validation sets must cross-over in successive rounds such that each data point has a chance of being validated against. The basic form of cross-validation is k-fold cross-validation. Other forms of cross-validation are special cases of k-fold cross-validation or involve repeated rounds of k-fold cross-validation.</p> <h2 id="how-we-understand-it">How we understand it?</h2> <p>Imagine one of your classmate yyxsb, we want to estimate whether he will come to school today or not. We have many data that he came to school or did’t in the past few months. As you know, if it rains, yyxsb may not come to school, but if he has any event, like has to submit his project review or has to present what he has done recently, he will have a good chance to go to school. There are many reasons that yyxsb don’t want to go to school.</p> <p>Here, to simply the problem, we assume the main reasons are weather, school event, holidays (yyxsb may come to school even on holidays), and the target is to estimate if he will come today. We have a table of data that recorded if he came to school that day.</p> <p>Then we can use some machine learning algorithms (like svm) to estimate if he will come on mon, tue, wen, thur, fri, sar, sun day.</p> <p>Ok, first we test will he come to school on monday, we use 75% of all data, to train the model and 25% of all data to test the model. Then we got our model, and we input the reasons to test if he will come today. Today is sunny, no event, monday, the algorithms tells us that yyxsb will come! In fact, he indeed comes to the school. The model seems fits well. Say, accuracy is 100%.</p> <p>Then, we use the same model on monday to test weather it work on other days or not, and we got not so bad result on tue/wen/thur day.</p> <p>Naive, naive, naive (Important things need to be repeated for three times). Things does not done, we will find that the model does not work well(may be bad, accuracy 30%) on fri/sat/sun day! Here we say the model <strong>overfitting</strong>.</p> <p>Because fri/sat/sun day may be different than other days, he may plan to chase girls or go to netbar and our input reasons don’t consider these things.</p> <p>If we can average the accuracy reselt tested for different days, then we know can get a accuracy, the example above is (100% * 4+30% * 3)/7 = 70%. Seems not too bad. But we have to notice that the model we use does not fit well in fri/sat/sun day! Dare you use it to persuade others that yyxsb will come on fri day?</p> <p>Ok, this model is not so good, then we shuffle the data, train another one. This time, we get a accuracy of [60%, 60%, 60%, 60%, 50%, 50%, 50%], then average accuracy is (60% * 4 + 50% * 3)/7 = 56%. Why we got a even lower accuracy? In this time, we average them, (70%+56%) = 63%, which seems more reliable.</p> <p>Why the accuracy is different? Because the amount of data we use is small, then we may got very unbelievable result. For example, We found that yyxsb come to school everyday on last week, we may assume that he will also come to school everyday this week or yyxsb come to school everyday since he was five, and he will come to school this week everyday, which sentence is more reliable?</p> <p>That means we cannot just believe our model by just one of the train test model.</p> <p>So the question is: how can we get a compellent result that the average accuracy our model shows if yyxsb will come today?</p> <p>First, let’s analyze why that phonomenon happens. yyxsb may have different action trend on different days, but if fact our model here assume that he have the same pattern every day! so there is no doubt that our model will fit so well on somedays while bad on other days. What caused that?– our test data contains too much information about somedays, while not other days. For example, our train data is mainly mon/tue/wen/thur, but test data are mainly fri/sat/sun, they have different patterns, so we will got very bad result.</p> <p>Ok, we got the reseans, then the question is: how to solve that problem?</p> <p>Since we can not believe just one train test result, then we just use many different train test models to get a average model, like figure 1.</p> <p>We need to prevent some overfiting, then we need use cross validation like above, to choose good parameters for the model.</p> <p>Also, if we want to try different algorithms, but we don’t know which is better, we can also use cross validation to get accuracy of all of them, then find a best algorithms to forcast if yyxsb will come to school.</p> <h2 id="how-to-make-your-grandmother-understand-cross-validation">How to make your grandmother understand cross validation?</h2> <p>Use the back ground above, we can tell your grandmother that because we only know that yyxsb came to school or not on the last week, we have 7 person to forcast weather yyxsb will come to school. For the first person A, we tell the man mon/tue/wen/thur/fri/sat data, then ask him to forcast if yyxsb will come on sunday, person A made a right forcast, 100% accuracy! For the first person A, we tell the man mon/tue/wen/thur/fri/sun data, then ask him to forcast if yyxsb will come on sartuday, person B made a wrong forcast, 0% accuracy! Similarly, we asked all of them to forcast one day this week, the accuracy is [100%, 0%, 0%, 100%, 100%, 0%, 100%, 100%].</p> <p>Then we ask all of them to forcast any day that yyxsb will come to school. Their anwser is [0%, 100%, 100%, 100%, 0%, 0%, 100%, 0%] You can ask your grandmother, who will you choose? Of course we will average their forcast! That is cross validation, we need all man to see diferent data, and average their suggestions.</p> <h2 id="why-we-need-it">Why we need it?</h2> <ul> <li>A methods to solve the problem of over fitting: <ul> <li>We divide the data in multiple ways, and then statistical methods are used to find the <strong>average accuracy</strong>.The train data we use may be only fit some of the system, the idea is that once we have identified our best combination of parameters (in our case time and route) we test the performance of that set of parameters in a different context. for example, we use mon as test, others are train data, we may found parameters works well in mon/thur/fri, but if we use the same model to test other days, it may not work well in tue/wen, we want the parameters works well in tue/wen too, so if we use different test data, then average them, so we can avoid some overfitting!</li> <li>It makes us more confident to the model trained on the training set. Without cross-validation, our model may perform pretty well on the training set, but the performance decreases when applied to the testing set.</li> </ul> </li> <li>To compare diffirent models: <ul> <li>Different models may fit well for different data, we need a standard to compare them. We got the average accuracy, then we can compare them</li> </ul> </li> </ul> <h2 id="how-it-works">How it works?</h2> <h3 id="k-fold">K-fold:</h3> <p><img src="/assets/img/ML/Cross_validation.png" alt="A intuition of cross validation" /> <em>K-fold cross validation</em></p> <ul> <li>Divide data into multiple chunks of train-test splits and get average accuracy</li> <li>The smaller the test, the better result we can get, but also <strong>takes longer</strong>(<a href="https://en.wikipedia.org/wiki/Cross-validation_(statistics)">LOOCV</a>) <h3 id="random-subsampling">Random subsampling:</h3> </li> <li>Randomly select test and train splits</li> </ul> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># How to use k-folds
</span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_iris</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">KFold</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="n">iris</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">()</span>
<span class="n">dataInput</span> <span class="o">=</span> <span class="n">iris</span><span class="p">.</span><span class="n">data</span>
<span class="n">dataOutput</span> <span class="o">=</span> <span class="n">iris</span><span class="p">.</span><span class="n">target</span>
<span class="n">kf</span> <span class="o">=</span> <span class="n">KFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">shuffle</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span> <span class="c1"># test data= all * 1/n_split
</span>
<span class="k">for</span> <span class="n">train_index</span><span class="p">,</span> <span class="n">test_index</span> <span class="ow">in</span> <span class="n">kf</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="n">dataInput</span><span class="p">):</span>
    <span class="n">x_train</span><span class="p">,</span><span class="n">x_test</span> <span class="o">=</span> <span class="n">dataInput</span><span class="p">[</span><span class="n">train_index</span><span class="p">],</span><span class="n">dataInput</span><span class="p">[</span><span class="n">test_index</span><span class="p">]</span>
    <span class="n">y_train</span><span class="p">,</span><span class="n">y_test</span> <span class="o">=</span> <span class="n">dataOutput</span><span class="p">[</span><span class="n">train_index</span><span class="p">],</span><span class="n">dataOutput</span><span class="p">[</span><span class="n">test_index</span><span class="p">]</span>
    <span class="s">"""
    here we can write our code to get our accuracy by different iteration(n_splits times), then get a average accuracy or we can use cross_val_score()function to finish all the work, like the code below
    """</span>
</code></pre></div></div> <h2 id="the-connections-to-ml-algorithms">The connections to ML algorithms</h2> <p>Often we can use cross validation and machine learning algorithms together, like CS + SVM/KNN, to get the best performance. It’s just a general data validation method, so we can use it in many machine learning algorithms.</p> <h3 id="usage">Usage:</h3> <ul> <li>use different machine learning algorithms, then compare the average accuracy, like: <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ignore import and data here
</span><span class="n">kf</span> <span class="o">=</span> <span class="n">KFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">clf_tree</span><span class="o">=</span><span class="n">DecisionTreeClassifier</span><span class="p">()</span>
<span class="n">scores</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">clf_tree</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">kf</span><span class="p">)</span>
<span class="n">avg_score</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">mean</span><span class="p">(</span><span class="n">score_array</span><span class="p">)</span>
</code></pre></div> </div> </li> <li>for one ML algorithm, choose the median parameters for the best performance, like: <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ignore import and data here
</span><span class="n">X</span> <span class="o">=</span> <span class="n">inputdata</span>   
<span class="n">y</span> <span class="o">=</span> <span class="n">outputdata</span>    <span class="c1"># target
</span><span class="n">kf</span> <span class="o">=</span> <span class="n">KFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">clf_tree</span><span class="o">=</span><span class="n">DecisionTreeClassifier</span><span class="p">()</span> <span class="c1"># model 1
</span><span class="n">scores1</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">clf_tree</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">kf</span><span class="p">)</span>
<span class="n">avg_score1</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">mean</span><span class="p">(</span><span class="n">score_array1</span><span class="p">)</span>
<span class="n">svm</span><span class="o">=</span><span class="n">SVM</span><span class="p">()</span>  <span class="c1"># model 2
</span><span class="n">scores2</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">svm</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">kf</span><span class="p">)</span>
<span class="n">avg_score2</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">mean</span><span class="p">(</span><span class="n">score_array2</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">avg_score1</span><span class="p">,</span> <span class="n">avg_score2</span><span class="p">)</span>
</code></pre></div> </div> <h3 id="drawbacks">Drawbacks</h3> <p>Need computing resource if the number of data is huge, so we seldom use it in Deep learning.</p> </li> </ul> <h2 id="summary">Summary</h2> <p>The key points are understdand how k-fold works, and why it works. Finally we can get a average accurcay to determine which model to use, or parameters to choose. Also, we have more confident on our method if we can use average accuracy to show our results.</p> <h2 id="reference">Reference</h2> <ol> <li><a href="https://www.pythonforengineers.com/cross-validation-and-model-selection/">Cross Validation and Model Selection</a></li> <li><a href="https://stats.stackexchange.com/questions/1826/cross-validation-in-plain-english">Cross-Validation in plain english</a></li> <li><a href="https://qiita.com/kibinag0/items/1a29db61fcb8c527d952">複数の機械学習ライブラリを一発で適応しちゃう方法</a></li> <li><a href="http://leitang.net/papers/ency-cross-validation.pdf">Cross-Validation</a></li> </ol> <hr align="center" width="14%"> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script> <!-- horizontal_ads --> <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4428678099867228" data-ad-slot="2208981001" data-ad-format="auto" data-full-width-responsive="true"></ins> <script> (adsbygoogle = window.adsbygoogle || []).push({}); </script> <div class="relatedPosts"> <h4 id="related_posts">You May Also Enjoy</h4> <script > $("#related_posts").hide(); </script> <script > $("#related_posts").show(); </script> <div> <h5><a href="/en/How_to_train_multiple_model_in_one_time_with_sklearn">How To Train Multiple Model In One Time With Sklearn <span class="label label-default">--Machine Learning</span> </a></h5> </div> <script > $("#related_posts").show(); </script> <div> <h5><a href="/en/A_least_squares_approach">A Least Squares Approach <span class="label label-default">--Machine Learning</span> </a></h5> </div> <script > $("#related_posts").show(); </script> <div> <h5><a href="/en/Linear_modeling_Maximum_likelihood_approach">Linear Modeling - A Maximum Likelihood Approach <span class="label label-default">--Machine Learning</span> </a></h5> </div> <script > $("#related_posts").show(); </script> <div> <h5><a href="/en/Bayesian_approach_to_machine_learning">The Bayesian Approach To Machine Learning <span class="label label-default">--Machine Learning</span> </a></h5> </div> <script > $("#related_posts").show(); </script> <div> <h5><a href="/en/Modeling_with_NMF_and_SVD">Modeling With NMF And SVD <span class="label label-default">--Machine Learning</span> </a></h5> </div> <script > $("#related_posts").show(); </script> <div> <h5><a href="/en/Feature_engineering">Feature Engineering For Machine Learning <span class="label label-default">--Machine Learning</span> </a></h5> </div> </div> <p><strong>Welcome to share or comment on this post: </strong></p> </article> <div class="post-share"> <div class="container"> <!-- AddToAny BEGIN --> <div class="a2a_kit a2a_kit_size_32 a2a_default_style" style=" float: unset; display: inline-flex; place-items: center;"> <a class="a2a_dd" href="https://www.addtoany.com/share"></a> <a class="a2a_button_wechat"></a> <a class="a2a_button_evernote"></a> <a class="a2a_button_line"></a> <a class="a2a_button_sina_weibo"></a> <a class="a2a_button_douban"></a> <a class="a2a_button_qzone"></a> </div> <script> var a2a_config = a2a_config || {}; a2a_config.onclick = 1; </script> <script async src="https://static.addtoany.com/menu/page.js"></script> <!-- AddToAny END --> </div> </div> <div class="comment container"> <div id="disqus_thread"> </div> </div> <div class="footer"> <div class="container"> <p class="footer-entry">All content is licensed under <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA</a></p> <p class="footer-entry">Built with <a href="http://jekyllrb.com/" target="_blank">Jekyll</a> and <a href="https://github.com/P233/3-Jekyll" target="_blank">3-Jekyll theme</a> • Hosted on <a href="https://pages.github.com/" target="_blank">Github</a></p> </div> </div> </main> <button id="menu" class="open"> <span id="menu-icons"></span> </button> <button id="post-toc-menu"> <span id="post-toc-menu-icons"></span> </button> <div id="post-toc"> <span id="post-toc-title">Table of Contents</span> <ul id="post-toc-ul"></ul> </div> <script src="/assets/js/jquery-2.1.3.min.js"></script> <script src="/assets/js/jquery.pjax.js"></script> <script src="/assets/js/nprogress.js"></script> <script src="/assets/js/main.js"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-143337798-1', 'auto'); ga('send', 'pageview'); </script> <!-- Load jQuery --> <!-- Load KaTeX --> </body> </html>
